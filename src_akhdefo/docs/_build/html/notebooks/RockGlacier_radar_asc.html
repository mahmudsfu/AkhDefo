<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Morenney Rock Glacier Radar Ascending &#8212; AkhDefo Software 2.3.125 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../_static/flask.css?v=b87c8d14" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script src="../_static/documentation_options.js?v=cdd0b548"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Morenney Rock Glacier Radar Descending" href="RockGlacier_radar_desc.html" />
    <link rel="prev" title="Morenny Rock Glacier Optical Imagery Example" href="RockGlacier_optical.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="RockGlacier_radar_desc.html" title="Morenney Rock Glacier Radar Descending"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="RockGlacier_optical.html" title="Morenny Rock Glacier Optical Imagery Example"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Akhdefo</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Morenney Rock Glacier Radar Ascending</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="Morenney-Rock-Glacier-Radar-Ascending">
<h1>Morenney Rock Glacier Radar Ascending<a class="headerlink" href="#Morenney-Rock-Glacier-Radar-Ascending" title="Link to this heading">¶</a></h1>
<section id="Prepare-Data-for-Bulk-Download">
<h2>Prepare Data for Bulk Download<a class="headerlink" href="#Prepare-Data-for-Bulk-Download" title="Link to this heading">¶</a></h2>
<p>Akhdefo processes radar imagery that has been corrected for radiometric and terrain distortions. Its function, ‘download_RTC,’ enables the downloading of Synthetic Aperture Radar (SAR) products from ASF’s HyP3 platform. Users can easily order RTC, AutoRIFT, and InSAR products with just a few lines of Python script. Firstly, users are advised to visit <a class="reference external" href="https://search.asf.alaska.edu/#/?maxResults=250">ASF’s website</a> to download metadata for their chosen time-series product granules. To assist
users, example screenshots are provided below as a guide to navigate through the process.</p>
<img alt="Step 1" src="../_images/asf1.png" />
<img alt="Step 1" src="../_images/asf2.png" />
</section>
<section id="Import-AkhDefo-Packages.">
<h2>Import AkhDefo Packages.<a class="headerlink" href="#Import-AkhDefo-Packages." title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1">#Functions for data preparations</span>
<span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">download_RTC</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">read_data_prep</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">move_files_with_string</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">Crop_to_AOI</span>

<span class="c1">#Functions data processing</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">scatter_area_mask</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">Raster_Correction</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">Optical_flow_akhdefo</span>

<span class="c1">#Functions for shapefile point data interpolation to raster geotif</span>
<span class="c1">#Function Autovariogram use Kriging method it fits the data to different variogram models and automatically use the best fit variogram model (Computationally Heavy but you can process data in chunks)</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">Auto_Variogram</span>

<span class="c1"># interpoate_xyz uses the following interpolation methods (nearest, linear and cubic)</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">interpolate_xyz</span>

<span class="c1">#Functions for data Visualization and Analysis</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">MeanProducts_plot_ts</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">plot_stackNetwork</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">akhdefo_viewer</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">akhdefo_dashApp</span>
</pre></div>
</div>
</div>
</section>
<section id="Download-Data-using-EarthData-ASF-Account">
<h2>Download Data using EarthData ASF Account<a class="headerlink" href="#Download-Data-using-EarthData-ASF-Account" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">First Run the below command and make sure {download=False} to see the granule paths and frames.</span>

<span class="sd">Its highly recommended to use data frame same path for the entire time-series for more accurate results</span>

<span class="sd">&#39;&#39;&#39;</span>


<span class="c1"># download_RTC( prompt=True, asf_datapool_results_file= &#39;./data/morenny/radar/asc/asf-datapool-results-2023-12-19_04-01-18.csv&#39;,</span>
<span class="c1">#             save_dir= &#39;./data/morenny/radar/asc/path129&#39;, job_name= &#39;RockGlacier_asc&#39;,</span>
<span class="c1">#             dem_matching= False,</span>
<span class="c1">#             include_dem= False,</span>
<span class="c1">#             include_inc_map= True,</span>
<span class="c1">#             include_rgb = False,</span>
<span class="c1">#             include_scattering_area= True,</span>
<span class="c1">#             scale = &#39;power&#39;,</span>
<span class="c1">#             resolution = 20,</span>
<span class="c1">#             speckle_filter= False,</span>
<span class="c1">#             radiometry=&#39;gamma0&#39;,</span>
<span class="c1">#             dem_name=&#39;copernicus&#39;, limit=None , download=False , path_number=129, RTC=False)</span>
</pre></div>
</div>
</div>
</section>
<section id="Extract-downloaded-zip-files">
<h2>Extract downloaded zip files<a class="headerlink" href="#Extract-downloaded-zip-files" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This functions extracts data from all the granuples zip directory.</span>
<span class="n">read_data_prep</span><span class="p">(</span><span class="n">zip_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/asc/path129_rtc/&#39;</span><span class="p">,</span>
                                 <span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/asc/RS_dir_path129&#39;</span><span class="p">,</span>
                                 <span class="n">ext_image_file</span><span class="o">=</span><span class="s1">&#39;VV.tif&#39;</span><span class="p">,</span> <span class="n">udm_mask_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/asc/scatter_dir&#39;</span><span class="p">,</span> <span class="n">ext_udm_mask_file</span><span class="o">=</span><span class="s1">&#39;area.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function will move all the data from each granules subdir to a single folder</span>
<span class="n">move_files_with_string</span><span class="p">(</span><span class="n">source_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/RS_dir_path129&#39;</span><span class="p">,</span> <span class="n">dest_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/RS_path129&#39;</span><span class="p">,</span> <span class="n">search_string</span><span class="o">=</span><span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="n">move_files_with_string</span><span class="p">(</span><span class="n">source_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/scatter_dir&#39;</span><span class="p">,</span> <span class="n">dest_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/scatter_rs&#39;</span><span class="p">,</span> <span class="n">search_string</span><span class="o">=</span><span class="s1">&#39;area.tif&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Optional:</span>

<span class="sd">Create an accumulated scatter area mask from a set of raster images based on a given threshold.</span>
<span class="sd">the input dataset is taken from ASF RTC processing.</span>
<span class="sd">The scattering area for each pixel in the RTC image in square meters.</span>
<span class="sd">The values are calculated based on the effectively illuminated gamma-0 terrain surface using a digital elevation model,</span>
<span class="sd">the local incidence angle map, and the layover-shadow map. see detailes</span>
<span class="sd">at the following website https://hyp3-docs.asf.alaska.edu/guides/rtc_product_guide/#scattering-area-map</span>
<span class="sd">The function processes each raster image in the input folder, crops it based on the provided AOI from the shapefile,</span>
<span class="sd">normalizes the cropped raster, and then converts the normalized image to a binary mask based on the scatter_percentageArea_threshold.</span>
<span class="sd">The binary masks from each raster are then accumulated to generate the final scatter area mask.</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="n">input_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/morenny/radar/asc/scatter_rs&quot;</span>
<span class="n">output_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/morenny/radar/asc/scatter_masks_20&quot;</span>
<span class="n">plot_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/morenny/radar/asc/scatter_mask_plots_20&quot;</span>
<span class="n">shapefile_path</span> <span class="o">=</span> <span class="s2">&quot;./data/morenny/AOI.shp&quot;</span>
<span class="n">scatter_Area_threshold</span><span class="o">=</span><span class="mi">5</span>
<span class="n">vegetation_mask_path</span><span class="o">=</span><span class="kc">None</span>


<span class="c1">#scatter_area_mask(input_folder, output_folder, plot_folder, shapefile_path, scatter_Area_threshold, vegetation_mask_path)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Crop all raster to Area of interest bounding box</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="n">Crop_to_AOI</span><span class="p">(</span><span class="n">Path_to_WorkingDir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/RS_path129/&#39;</span><span class="p">,</span>
                              <span class="n">Path_to_AOI_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span><span class="p">,</span>
                              <span class="n">output_CroppedDir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/RS_cropped_path129&#39;</span><span class="p">,</span> <span class="n">file_ex</span><span class="o">=</span><span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
</section>
<section id="Preparing-raster-for-radar-flow-and-displacement-calculation!">
<h2>Preparing raster for radar flow and displacement calculation!<a class="headerlink" href="#Preparing-raster-for-radar-flow-and-displacement-calculation!" title="Link to this heading">¶</a></h2>
<p>By deafult RTC data comes in the below three formats. The below raster correction function converts the below RTC data formats to Unassigned 8 bit integer(“uint8”).</p>
<ul class="simple">
<li><p>Power Scale: SAR images in the power scale represent the square of the amplitude. Power is a measure of the energy of the radar signal returned from each point on the ground. It’s more intuitive in terms of energy interpretation but less used for visual interpretation due to its non-linear nature.</p></li>
<li><p>Amplitude Scale: The amplitude scale is a direct representation of the radar signal’s strength received from each point. It’s more commonly used for visual interpretation since it’s more linear than the power scale. Amplitude images are easier to interpret but can be sensitive to noise.</p></li>
<li><p>Decibel (dB) Scale: The decibel scale is a logarithmic scale used to express SAR data. It’s derived from the amplitude or power scale and is used to compress the dynamic range of the SAR data. The dB scale is beneficial for enhancing certain features in the data, especially in areas with very high or very low backscatter.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">akhdefo_functions</span>

<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">Raster_Correction</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s2">&quot;./data/morenny/radar/asc/RS_cropped_path129&quot;</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;./data/morenny/radar/asc/RS_cropped_path129_filt&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">lowpass_kernel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bilateral_win_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">bilateral_sigma_color</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                    <span class="n">bilateral_sigma_spatial</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                    <span class="n">clip_percentiles</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">98</span><span class="p">],</span> <span class="n">optical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="n">Vegetation_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing images: 100%|██████████| 57/57 [04:09&lt;00:00,  4.38s/image]
</pre></div></div>
</div>
</section>
<section id="Applying-radar-flow-and-producing-time-series-deformation-products.">
<h2>Applying radar flow and producing time-series deformation products.<a class="headerlink" href="#Applying-radar-flow-and-producing-time-series-deformation-products." title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">Optical_flow_akhdefo</span><span class="p">(</span><span class="n">input_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/RS_cropped_path129_filt&#39;</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129&#39;</span><span class="p">,</span> <span class="n">AOI</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span><span class="p">,</span> <span class="n">zscore_threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                       <span class="n">ssim_thresh</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">image_resolution</span><span class="o">=</span><span class="s1">&#39;20m&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="s1">&#39;kriging&#39;</span><span class="p">,</span>
                                       <span class="n">show_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dem_path</span><span class="o">=</span><span class="s1">&#39;./data/morenny/dem.tif&#39;</span><span class="p">,</span> <span class="n">smoothing_kernel_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                       <span class="n">Vegetation_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">VEL_scale</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">VEL_Mode</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">good_match_option</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                       <span class="n">hillshade_option</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shapefile_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_triplet_interval</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlap_percentage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pyr_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                       <span class="n">winsize</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">poly_n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">poly_sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                       <span class="n">flags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">master_reference</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
                                       <span class="n">selection_Mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;20170101&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;20240101&#39;</span><span class="p">,</span> <span class="n">krig_method</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">,</span> <span class="n">spatial_ref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_zscore_krig</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">orbit_dir</span><span class="o">=</span><span class="s1">&#39;asc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:   0%|          | 0/51 [00:00&lt;?, ?it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.9117958415806315
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: TPLSimple and score: 0.8128202933450142
kriging succeed with Model: JBessel and score: 0.7586042313290209
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:   2%|▏         | 1/51 [00:06&lt;05:37,  6.76s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8459779862801646
kriging succeed with Model: Integral and score: 0.829582835534719
Error with model Stable: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Integral and score: 0.8448362732546969
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:   4%|▍         | 2/51 [00:17&lt;07:27,  9.12s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8818259019914758
Error with model Rational: Internal Error.
kriging succeed with Model: Stable and score: 0.5748475993079408
kriging succeed with Model: JBessel and score: 0.8076662391978803
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:   6%|▌         | 3/51 [00:24&lt;06:24,  8.01s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Matern and score: 0.8966609741798325
kriging succeed with Model: JBessel and score: 0.817425851625083
kriging succeed with Model: Rational and score: 0.8855308880678211
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:   8%|▊         | 4/51 [00:34&lt;06:57,  8.88s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.9531139658698505
kriging succeed with Model: Stable and score: 0.8943975974898883
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: JBessel and score: 0.9015561760923133
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  10%|▉         | 5/51 [00:40&lt;06:08,  8.00s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.9830005954217444
kriging succeed with Model: SuperSpherical and score: 0.9720723200601938
kriging succeed with Model: TPLSimple and score: 0.7600917530234869
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  12%|█▏        | 6/51 [00:46&lt;05:22,  7.16s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: TPLSimple and score: 0.912553668059078
kriging succeed with Model: SuperSpherical and score: 0.7168026068095877
kriging succeed with Model: SuperSpherical and score: 0.9012192703385514
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  14%|█▎        | 7/51 [00:50&lt;04:26,  6.06s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.8923455108200049
kriging succeed with Model: Stable and score: 0.9384370839329463
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: JBessel and score: 0.8617157188958802
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  16%|█▌        | 8/51 [00:57&lt;04:37,  6.45s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.7611407656481421
kriging succeed with Model: Integral and score: 0.8457507619448921
kriging succeed with Model: Integral and score: 0.839356982950073
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  18%|█▊        | 9/51 [01:06&lt;04:59,  7.14s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8173825870444007
kriging succeed with Model: JBessel and score: 0.6249394508666187
kriging succeed with Model: Rational and score: 0.592565411815521
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  20%|█▉        | 10/51 [01:14&lt;05:02,  7.37s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: TPLSimple and score: 0.835436588495504
kriging succeed with Model: SuperSpherical and score: 0.9599242291477337
kriging succeed with Model: Stable and score: 0.9700641006078058
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  22%|██▏       | 11/51 [01:18&lt;04:20,  6.52s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.6438658856627559
kriging succeed with Model: Integral and score: 0.8142472558228872
kriging succeed with Model: Rational and score: 0.5281421509733835
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  24%|██▎       | 12/51 [01:26&lt;04:31,  6.96s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.6243355952378049
kriging succeed with Model: Stable and score: 0.6678600222212071
kriging succeed with Model: JBessel and score: 0.7305235870271204
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  25%|██▌       | 13/51 [01:32&lt;04:15,  6.71s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Integral and score: 0.8600073148266875
kriging succeed with Model: Stable and score: 0.7825994344297309
kriging succeed with Model: Integral and score: 0.8176360593990477
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  27%|██▋       | 14/51 [01:39&lt;04:07,  6.69s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: TPLSimple and score: 0.7813784447192704
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: JBessel and score: 0.9395198574858437
kriging succeed with Model: Rational and score: 0.9229198616536649
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  29%|██▉       | 15/51 [01:45&lt;03:55,  6.54s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.5491321444476807
kriging succeed with Model: Stable and score: 0.907381038701257
kriging succeed with Model: Cubic and score: 0.6965511027076774
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  31%|███▏      | 16/51 [01:49&lt;03:26,  5.89s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: HyperSpherical and score: 0.8520773965800563
kriging succeed with Model: Stable and score: 0.9608920841689735
kriging succeed with Model: Integral and score: 0.7624646445101271
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  33%|███▎      | 17/51 [01:54&lt;03:09,  5.56s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.7400734693828392
kriging succeed with Model: JBessel and score: 0.8695990279066965
kriging succeed with Model: Rational and score: 0.7532224896470118
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  35%|███▌      | 18/51 [02:02&lt;03:24,  6.21s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8084096312352832
kriging succeed with Model: Stable and score: 0.8148741383904521
kriging succeed with Model: Rational and score: 0.8942257205755528
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  37%|███▋      | 19/51 [02:08&lt;03:15,  6.10s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: TPLSimple and score: 0.9368607724329118
kriging succeed with Model: TPLSimple and score: 0.7901083507566035
kriging succeed with Model: JBessel and score: 0.8513867641129587
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  39%|███▉      | 20/51 [02:14&lt;03:06,  6.00s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: TPLSimple and score: 0.7846542703934465
kriging succeed with Model: JBessel and score: 0.8244379423996986
Error with model JBessel: Internal Error.
kriging succeed with Model: Cubic and score: 0.8888852517943856
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  41%|████      | 21/51 [02:20&lt;03:01,  6.07s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.8220443128738055
kriging succeed with Model: Gaussian and score: 0.8426594396092643
kriging succeed with Model: Stable and score: 0.6352434126345343
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  43%|████▎     | 22/51 [02:30&lt;03:32,  7.34s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.7759510386454831
kriging succeed with Model: TPLSimple and score: 0.7704523990674673
kriging succeed with Model: JBessel and score: 0.7764411867608005
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  45%|████▌     | 23/51 [02:36&lt;03:13,  6.90s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.5265739504084185
kriging succeed with Model: HyperSpherical and score: 0.6844591315935027
kriging succeed with Model: HyperSpherical and score: 0.4637207522835224
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  47%|████▋     | 24/51 [02:40&lt;02:42,  6.04s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.6357618482942977
kriging succeed with Model: JBessel and score: 0.8183026984139241
kriging succeed with Model: JBessel and score: 0.5361738234891591
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  49%|████▉     | 25/51 [02:50&lt;03:06,  7.18s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: JBessel and score: 0.616093208929023
Error with model TPLSimple: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Cubic and score: 0.11407445749354328
Error with model Stable: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model TPLSimple: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Cubic and score: 0.15098803468588962
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  51%|█████     | 26/51 [02:59&lt;03:10,  7.64s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.8205167152755075
kriging succeed with Model: TPLSimple and score: 0.9133610278754546
kriging succeed with Model: Rational and score: 0.8546482087495701
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  53%|█████▎    | 27/51 [03:05&lt;02:53,  7.21s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8062493527657227
kriging succeed with Model: Rational and score: 0.8499556307979779
kriging succeed with Model: Rational and score: 0.9507441326047522
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  55%|█████▍    | 28/51 [03:09&lt;02:27,  6.43s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.9732894170632433
kriging succeed with Model: Integral and score: 0.9291466767196762
kriging succeed with Model: Stable and score: 0.8955821544767468
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  57%|█████▋    | 29/51 [03:16&lt;02:24,  6.55s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Integral and score: 0.9759214952018477
kriging succeed with Model: Integral and score: 0.8187211420912107
kriging succeed with Model: Stable and score: 0.9522683928551086
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  59%|█████▉    | 30/51 [03:25&lt;02:32,  7.25s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.6988352354346266
kriging succeed with Model: TPLSimple and score: 0.9256186588150337
kriging succeed with Model: Rational and score: 0.739206011809552
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  61%|██████    | 31/51 [03:29&lt;02:04,  6.21s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Stable and score: 0.8605394531183703
kriging succeed with Model: JBessel and score: 0.9469251801167559
kriging succeed with Model: JBessel and score: 0.9000447220715753
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  63%|██████▎   | 32/51 [03:36&lt;02:00,  6.34s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Integral and score: 0.847221829463584
kriging succeed with Model: JBessel and score: 0.9051812626992448
kriging succeed with Model: HyperSpherical and score: 0.8947683816187691
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  65%|██████▍   | 33/51 [03:44&lt;02:03,  6.84s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: SuperSpherical and score: 0.8274735489272544
kriging succeed with Model: Integral and score: 0.9129098345184716
kriging succeed with Model: Integral and score: 0.861984292204776
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  67%|██████▋   | 34/51 [03:50&lt;01:54,  6.72s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.8113219001102806
kriging succeed with Model: JBessel and score: 0.8749669562841375
kriging succeed with Model: Rational and score: 0.7817848102667992
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  69%|██████▊   | 35/51 [03:56&lt;01:46,  6.63s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: JBessel and score: 0.9097264650960574
kriging succeed with Model: TPLSimple and score: 0.9274020234185868
kriging succeed with Model: TPLSimple and score: 0.6901436935162784
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  71%|███████   | 36/51 [04:02&lt;01:36,  6.46s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Integral and score: 0.9406142471150734
kriging succeed with Model: Rational and score: 0.88586258776035
kriging succeed with Model: Rational and score: 0.8550225272051408
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  73%|███████▎  | 37/51 [04:08&lt;01:25,  6.08s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error with model JBessel: Internal Error.
kriging succeed with Model: Matern and score: 0.22157307684511585
Error with model JBessel: Internal Error.
kriging succeed with Model: SuperSpherical and score: -0.8201725550674748
kriging succeed with Model: JBessel and score: 0.32905694925765117
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  75%|███████▍  | 38/51 [04:12&lt;01:13,  5.63s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: HyperSpherical and score: 0.9280975605084308
kriging succeed with Model: JBessel and score: 0.6883664689895312
kriging succeed with Model: Stable and score: 0.6931290635816129
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  76%|███████▋  | 39/51 [04:18&lt;01:07,  5.63s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.9517591294877166
kriging succeed with Model: HyperSpherical and score: 0.8704087503053812
kriging succeed with Model: Rational and score: 0.6655341901776402
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  78%|███████▊  | 40/51 [04:24&lt;01:03,  5.80s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.9443954974387242
kriging succeed with Model: Integral and score: 0.9291706645812505
kriging succeed with Model: Stable and score: 0.7126085441740314
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  80%|████████  | 41/51 [04:32&lt;01:04,  6.42s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.7563742631601303
kriging succeed with Model: Integral and score: 0.951872962214248
kriging succeed with Model: JBessel and score: 0.8243497853467985
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  82%|████████▏ | 42/51 [04:40&lt;01:02,  6.93s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.6779877573231676
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Rational and score: 0.8298748431505133
kriging succeed with Model: JBessel and score: 0.8103172477861078
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  84%|████████▍ | 43/51 [04:48&lt;00:57,  7.13s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.7309665458274002
kriging succeed with Model: Integral and score: 0.8704670489970965
kriging succeed with Model: HyperSpherical and score: 0.7083074511048983
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  86%|████████▋ | 44/51 [04:55&lt;00:50,  7.15s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.6615860349963171
kriging succeed with Model: TPLSimple and score: 0.886791884220187
kriging succeed with Model: SuperSpherical and score: 0.5825014277006373
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  88%|████████▊ | 45/51 [04:59&lt;00:37,  6.20s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.7091625254060225
kriging succeed with Model: Integral and score: 0.8898354333714579
kriging succeed with Model: SuperSpherical and score: 0.8290355157507839
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  90%|█████████ | 46/51 [05:06&lt;00:32,  6.55s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Integral and score: 0.9325968558639923
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: Stable and score: 0.8220837754558719
kriging succeed with Model: JBessel and score: 0.8454523816399887
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  92%|█████████▏| 47/51 [05:15&lt;00:28,  7.22s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: JBessel and score: 0.7914385982355338
kriging succeed with Model: HyperSpherical and score: 0.8960408756696585
kriging succeed with Model: Stable and score: 0.7575001589674966
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  94%|█████████▍| 48/51 [05:21&lt;00:20,  6.82s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error with model JBessel: Internal Error.
kriging succeed with Model: Stable and score: 0.30078259268444274
kriging succeed with Model: Gaussian and score: 0.6608586707180364
kriging succeed with Model: JBessel and score: 0.2303749880664212
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  96%|█████████▌| 49/51 [05:26&lt;00:12,  6.41s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Stable and score: 0.8118874895980179
kriging succeed with Model: Stable and score: 0.7550195521434067
kriging succeed with Model: JBessel and score: 0.5346245590224654
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing:  98%|█████████▊| 50/51 [05:33&lt;00:06,  6.57s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: SuperSpherical and score: 0.8659303364666839
kriging succeed with Model: Stable and score: 0.7106821881160753
kriging succeed with Model: Integral and score: 0.9228906554187711
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing: 100%|██████████| 51/51 [05:40&lt;00:00,  6.68s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wait for processing to complete writing data into shapefile for timeseries...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Preparing GeoDataFrames: 100%|██████████| 51/51 [00:00&lt;00:00, 969.29it/s]
Preparing GeoDataFrames: 100%|██████████| 51/51 [00:00&lt;00:00, 977.98it/s]
Preparing GeoDataFrames: 100%|██████████| 51/51 [00:00&lt;00:00, 1025.68it/s]
100%|██████████| 51/51 [00:00&lt;00:00, 68.55it/s]          | 0/3 [00:00&lt;?, ?it/s]
100%|██████████| 51/51 [00:00&lt;00:00, 69.05it/s]███▎      | 1/3 [00:00&lt;00:01,  1.32it/s]
100%|██████████| 51/51 [00:00&lt;00:00, 68.16it/s]██████▋   | 2/3 [00:01&lt;00:00,  1.32it/s]
Processing:Updating and Cropping Rasters: 100%|██████████| 3/3 [00:02&lt;00:00,  1.32it/s]
Processing: Update Shapefiles :   0%|          | 0/3 [00:00&lt;?, ?it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_2DVEL.shp started...

208
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing: Update Shapefiles :  33%|███▎      | 1/3 [00:12&lt;00:24, 12.23s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ReferencePoint x, y: (662633.3155059814, 4763562.618217468), VEL, VEL_STD: (0.12596796, 0.074020244)
processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_2DVEL.shp completed...

processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_N.shp started...

208
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing: Update Shapefiles :  67%|██████▋   | 2/3 [00:23&lt;00:11, 11.93s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ReferencePoint x, y: (662633.3155059814, 4763562.618217468), VEL, VEL_STD: (0.049556363, 0.052669924)
processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_N.shp completed...

processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_E.shp started...

208
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing: Update Shapefiles : 100%|██████████| 3/3 [00:35&lt;00:00, 11.90s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ReferencePoint x, y: (662633.3155059814, 4763562.618217468), VEL, VEL_STD: (-0.0902256, 0.06325131)
processing ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/20170718_20230921_20230921_E.shp completed...

Total Days: 2256
file used ./data/morenny/radar/asc/geo_path129/temp_shapefile_dir\updated_shapefiles\20170718_20230921_20230921_2DVEL.shp.xml
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
start calculating aspect...
calculating aspect completed
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="n">ColorbarBase</span>

<span class="c1"># Define the custom CMY colors (normalized to [0, 1])</span>
<span class="n">custom_colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c1"># Cyan</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># Yellow</span>
    <span class="p">,(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># Magenta</span>
    <span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># Cyan</span>

<span class="p">]</span>

<span class="c1"># Create the custom CMY colormap with a specified number of bins (256 in this case)</span>
<span class="n">custom_colormap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;custom_cmy&quot;</span><span class="p">,</span> <span class="n">custom_colors</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>

<span class="c1"># Display the custom CMY colormap</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">cbar_cmy</span> <span class="o">=</span> <span class="n">ColorbarBase</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">custom_colormap</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cbar_cmy</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Custom  Colormap&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_15_0.png" src="../_images/notebooks_RockGlacier_radar_asc_15_0.png" />
</div>
</div>
</section>
<section id="Interpolate-and-Create-raster-Velocities">
<h2>Interpolate and Create raster Velocities<a class="headerlink" href="#Interpolate-and-Create-raster-Velocities" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="kn">from</span> <span class="nn">akhdefo_functions</span> <span class="kn">import</span> <span class="n">Auto_Variogram</span>

<span class="n">Auto_Variogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_N.shp&#39;</span><span class="p">,</span> <span class="n">column_attribute</span><span class="o">=</span><span class="s1">&#39;VEL&#39;</span>
               <span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_fileName</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">geo_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span><span class="p">,</span> <span class="n">plot_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span>
               <span class="p">,</span> <span class="n">smoothing_kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latlon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aoi_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span> <span class="p">,</span>  <span class="n">krig_method</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">)</span>


<span class="n">Auto_Variogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_E.shp&#39;</span><span class="p">,</span> <span class="n">column_attribute</span><span class="o">=</span><span class="s1">&#39;VEL&#39;</span>
               <span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_fileName</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">geo_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span><span class="p">,</span> <span class="n">plot_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span>
               <span class="p">,</span> <span class="n">smoothing_kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latlon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aoi_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span><span class="p">,</span>  <span class="n">krig_method</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">)</span>



<span class="n">Auto_Variogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_2DVEL.shp&#39;</span><span class="p">,</span> <span class="n">column_attribute</span><span class="o">=</span><span class="s1">&#39;VEL&#39;</span>
               <span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_fileName</span><span class="o">=</span><span class="s1">&#39;2DVEL&#39;</span><span class="p">,</span> <span class="n">geo_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span><span class="p">,</span> <span class="n">plot_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span>
               <span class="p">,</span> <span class="n">smoothing_kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latlon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aoi_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span><span class="p">,</span>  <span class="n">krig_method</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">,</span> <span class="n">detrend_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="n">Auto_Variogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_2DVEL.shp&#39;</span><span class="p">,</span> <span class="n">column_attribute</span><span class="o">=</span><span class="s1">&#39;aspect&#39;</span>
               <span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_chunks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_fileName</span><span class="o">=</span><span class="s1">&#39;aspect&#39;</span><span class="p">,</span> <span class="n">geo_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span><span class="p">,</span> <span class="n">plot_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder&#39;</span>
               <span class="p">,</span> <span class="n">smoothing_kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latlon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aoi_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/AOI.shp&#39;</span><span class="p">,</span>  <span class="n">krig_method</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">,</span> <span class="n">detrend_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_zscore</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kriging succeed with Model: Rational and score: 0.9814417913979501
kriging succeed with Model: JBessel and score: 0.9741611045248206
kriging succeed with Model: JBessel and score: 0.9824853557186365
Error with model Gaussian: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Exponential: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Matern: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Integral: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Cubic: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Stable: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Rational: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model Spherical: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model TPLSimple: Optimal parameters not found: The maximum number of function evaluations is exceeded.
Error with model JBessel: Optimal parameters not found: The maximum number of function evaluations is exceeded.
kriging succeed with Model: SuperSpherical and score: -0.07392620877802125
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       [         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       [         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       ...,
       [193.64870949, 193.59875574, 193.54880198, ...,          nan,
                 nan,          nan],
       [         nan, 193.60636963, 193.55641588, ...,          nan,
                 nan,          nan],
       [         nan,          nan, 193.56402977, ...,          nan,
                 nan,          nan]])
</pre></div></div>
</div>
</section>
<section id="Visualize-Displacement-Products">
<h2>Visualize Displacement Products<a class="headerlink" href="#Visualize-Displacement-Products" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">calculate_and_save_aspect_raster</span><span class="p">(</span><span class="n">ew_raster_path</span><span class="o">=</span> <span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/E_universal.tif&#39;</span><span class="p">,</span> <span class="n">ns_raster_path</span><span class="o">=</span> <span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/N_universal.tif&#39;</span><span class="p">,</span>
                                 <span class="n">output_raster_path</span><span class="o">=</span> <span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/aspect.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="kn">import</span> <span class="nn">cmocean.cm</span> <span class="k">as</span> <span class="nn">cmo</span>

<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_viewer</span><span class="p">(</span><span class="n">path_to_dem_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/basemap.tif&#39;</span><span class="p">,</span> <span class="n">raster_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/detrend/2DVEL_universal_detrend.tif&#39;</span><span class="p">,</span>
                                 <span class="n">output_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Detreneded 2D Velocity </span><span class="se">\n</span><span class="s1"> Radar(Ascending)&#39;</span><span class="p">,</span>
                   <span class="n">pixel_resolution_meters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file_name</span><span class="o">=</span><span class="s2">&quot;2DVEL_WithVectorMotion_detrend.png&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">unit_conversion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">no_data_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;jet_r&#39;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;meter/year&#39;</span><span class="p">,</span> <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_20_0.png" src="../_images/notebooks_RockGlacier_radar_asc_20_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="kn">import</span> <span class="nn">cmocean.cm</span> <span class="k">as</span> <span class="nn">cmo</span>

<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_viewer</span><span class="p">(</span><span class="n">path_to_dem_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/basemap.tif&#39;</span><span class="p">,</span> <span class="n">raster_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/2DVEL_universal.tif&#39;</span><span class="p">,</span>
                                 <span class="n">output_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;2D Velocity(Ascending) with Vector Motion&#39;</span><span class="p">,</span>
                   <span class="n">pixel_resolution_meters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file_name</span><span class="o">=</span><span class="s2">&quot;2DVEL_WithVectorMotion.png&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">unit_conversion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">no_data_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span>
                   <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;meter/year&#39;</span><span class="p">,</span> <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">aspect_raster</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/aspect.tif&#39;</span><span class="p">,</span> <span class="n">cmap_aspect</span><span class="o">=</span><span class="s1">&#39;hsv_r&#39;</span> <span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_21_0.png" src="../_images/notebooks_RockGlacier_radar_asc_21_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Visualize Mean Velocity East-West</span>
<span class="c1"># if set batch_plot=True it will plot static time series figure for each date acquisition</span>
<span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">MeanProducts_plot_ts</span><span class="p">(</span><span class="n">path_to_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_E.shp&#39;</span><span class="p">,</span>
                                       <span class="n">dem_path</span><span class="o">=</span><span class="s1">&#39;./data/morenny/dem.tif&#39;</span><span class="p">,</span> <span class="n">out_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/E&#39;</span><span class="p">,</span>
                                       <span class="n">color_field</span><span class="o">=</span><span class="s2">&quot;VEL&quot;</span><span class="p">,</span> <span class="n">Set_fig_MinMax</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">MinMaxRange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                       <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;East-West (m/year)&#39;</span><span class="p">,</span>
                                       <span class="n">batch_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#Visualize Mean Velocity North-South</span>
<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">MeanProducts_plot_ts</span><span class="p">(</span><span class="n">path_to_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_N.shp&#39;</span><span class="p">,</span>
                                       <span class="n">dem_path</span><span class="o">=</span><span class="s1">&#39;./data/morenny/dem.tif&#39;</span><span class="p">,</span> <span class="n">out_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/N&#39;</span><span class="p">,</span>
                                       <span class="n">color_field</span><span class="o">=</span><span class="s2">&quot;VEL&quot;</span><span class="p">,</span> <span class="n">Set_fig_MinMax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">MinMaxRange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                       <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;North-South (m/year)&#39;</span><span class="p">,</span>
                                       <span class="n">batch_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#Visualize Mean Velocity 2D Velocity</span>
<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">MeanProducts_plot_ts</span><span class="p">(</span><span class="n">path_to_shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_2DVEL.shp&#39;</span><span class="p">,</span>
                                       <span class="n">dem_path</span><span class="o">=</span><span class="s1">&#39;./data/morenny/dem.tif&#39;</span><span class="p">,</span> <span class="n">out_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/2D&#39;</span><span class="p">,</span>
                                       <span class="n">color_field</span><span class="o">=</span><span class="s2">&quot;VEL&quot;</span><span class="p">,</span> <span class="n">Set_fig_MinMax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">MinMaxRange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                       <span class="n">cmap</span><span class="o">=</span><span class="n">custom_colormap</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                       <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;2D-VEL (meter/year)&#39;</span><span class="p">,</span>
                                       <span class="n">batch_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_inverse_Vel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_22_0.png" src="../_images/notebooks_RockGlacier_radar_asc_22_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_22_1.png" src="../_images/notebooks_RockGlacier_radar_asc_22_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_22_2.png" src="../_images/notebooks_RockGlacier_radar_asc_22_2.png" />
</div>
</div>
</section>
<section id="Interactive-Time-Series-Analysis-in-a-Dash-Web-App">
<h2>Interactive Time Series Analysis in a Dash Web App<a class="headerlink" href="#Interactive-Time-Series-Analysis-in-a-Dash-Web-App" title="Link to this heading">¶</a></h2>
<p>This plot is part of an interactive web application. Users have the ability to select groups of data points using either the box select or lasso tool, which are superimposed on a satellite image base map. The selected data will then be reflected in the time series chart. Additionally, users can customize the axis labels to suit their dataset; for example, if the dataset measures displacement or velocity in meters, the y-axis label can be adjusted accordingly from the default mm. Furthermore,
users can download their analysis and the generated figures directly from the web application.</p>
<img alt="dash2d_radar output sample" src="../_images/dash2d11.png" />
<img alt="dash2d_radar output sample1" src="../_images/newplot111.png" />
<img alt="dash2d_radar output sample2" src="../_images/newplot12.png" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">akhdefo_functions</span>

<span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_dashApp</span><span class="p">(</span>
<span class="n">Path_to_Shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230921_20230921_2DVEL.shp&#39;</span><span class="p">,</span>
                                  <span class="n">port</span><span class="o">=</span><span class="mi">8037</span><span class="p">,</span> <span class="n">BaseMap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basemap_type</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    width="100%"
    height="650"
    src="http://127.0.0.1:8037/"
    frameborder="0"
    allowfullscreen

></iframe></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">akhdefo_dashApp</span><span class="p">(</span>
<span class="n">Path_to_Shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230828_20230828_N.shp&#39;</span><span class="p">,</span>
                                  <span class="n">port</span><span class="o">=</span><span class="mi">8056</span><span class="p">,</span> <span class="n">BaseMap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basemap_type</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">akhdefo_dashApp</span><span class="p">(</span>
<span class="n">Path_to_Shapefile</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/geo_path129/temp_shapefile_dir/updated_shapefiles/20170718_20230828_20230828_E.shp&#39;</span><span class="p">,</span>
                                  <span class="n">port</span><span class="o">=</span><span class="mi">8055</span><span class="p">,</span> <span class="n">BaseMap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basemap_type</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plot-Mean-Land-Surface-Temperature-for-months-July-and-August-2017-to-2021">
<h2>Plot Mean Land Surface Temperature for months July and August 2017 to 2021<a class="headerlink" href="#Plot-Mean-Land-Surface-Temperature-for-months-July-and-August-2017-to-2021" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">akhdefo_functions</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">ee</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>  <span class="c1"># For enhanced plot styling</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1">#akhdefo_functions.Crop_to_AOI(&#39;./data/morenny/LST/&#39;, &#39;./data/morenny/AOI.shp&#39;, &quot;./data/morenny/LST/cropped&quot; )</span>
<span class="n">directory_path</span> <span class="o">=</span> <span class="s1">&#39;./data/morenny/LST/cropped&#39;</span>
<span class="n">basemap_path</span> <span class="o">=</span> <span class="s1">&#39;./data/morenny/basemap.tif&#39;</span>



<span class="c1"># Read the projection from the basemap</span>
<span class="n">basemap_ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">basemap_path</span><span class="p">)</span>
<span class="n">basemap_proj</span> <span class="o">=</span> <span class="n">basemap_ds</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">()</span>

<span class="c1"># List all files in the specified path</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span>

<span class="n">mean_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">dates</span><span class="o">=</span><span class="p">[]</span>
<span class="n">date_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d</span><span class="si">{4}</span><span class="s1">\d</span><span class="si">{2}</span><span class="s1">\d</span><span class="si">{2}</span><span class="s1">&#39;</span>  <span class="c1"># Adjust this pattern based on your filename date format</span>

<span class="k">def</span> <span class="nf">extract_year_from_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="c1"># Regular expression pattern to find a four-digit year</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d</span><span class="si">{4}</span><span class="s1">&#39;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="c1"># Return the matched year</span>
        <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Test the function</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
    <span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tif&#39;</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>

        <span class="c1"># Create a temporary file for the reprojected raster</span>
        <span class="n">temp_outputname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;reprojected_</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Reproject the raster to match the basemap&#39;s projection</span>
        <span class="n">gdal</span><span class="o">.</span><span class="n">Warp</span><span class="p">(</span><span class="n">destNameOrDestDS</span><span class="o">=</span><span class="n">temp_outputname</span><span class="p">,</span>
                  <span class="n">srcDSOrSrcDSTab</span><span class="o">=</span><span class="n">full_path</span><span class="p">,</span>
                  <span class="n">dstSRS</span><span class="o">=</span><span class="n">basemap_proj</span><span class="p">)</span>

        <span class="c1">####################</span>
         <span class="c1"># Open the reprojected raster and calculate its mean</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">temp_outputname</span><span class="p">)</span>
        <span class="n">band</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">band</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span>
        <span class="n">mean_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Exclude no-data values</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">date_pattern</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">year</span><span class="o">=</span><span class="n">extract_year_from_string</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">mean_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_value</span><span class="p">)</span>
        <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>

        <span class="c1">#################</span>

        <span class="c1"># Call your custom function with the necessary parameters</span>
        <span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_viewer</span><span class="p">(</span>
            <span class="n">path_to_dem_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/basemap.tif&#39;</span><span class="p">,</span>
            <span class="n">raster_file</span><span class="o">=</span><span class="n">temp_outputname</span><span class="p">,</span>
            <span class="n">output_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/&#39;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
            <span class="n">pixel_resolution_meters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">output_file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">unit_conversion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">no_data_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;hsv_r&#39;</span><span class="p">,</span>
            <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;celsius-degree &#39;</span><span class="p">,</span>
            <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">aspect_raster</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/VEL_Folder/aspect.tif&#39;</span><span class="p">,</span>
            <span class="n">cmap_aspect</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>

        <span class="n">ds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">band</span><span class="o">=</span><span class="kc">None</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_outputname</span><span class="p">)</span>
         <span class="c1"># Find date in the filename</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 9/9 [00:00&lt;00:00, 83.15it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_1.png" src="../_images/notebooks_RockGlacier_radar_asc_29_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_2.png" src="../_images/notebooks_RockGlacier_radar_asc_29_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_3.png" src="../_images/notebooks_RockGlacier_radar_asc_29_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_4.png" src="../_images/notebooks_RockGlacier_radar_asc_29_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_5.png" src="../_images/notebooks_RockGlacier_radar_asc_29_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_6.png" src="../_images/notebooks_RockGlacier_radar_asc_29_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_7.png" src="../_images/notebooks_RockGlacier_radar_asc_29_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_8.png" src="../_images/notebooks_RockGlacier_radar_asc_29_8.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_29_9.png" src="../_images/notebooks_RockGlacier_radar_asc_29_9.png" />
</div>
</div>
<section id="Detrend-Land-Surface-Temperature-data">
<h3>Detrend Land Surface Temperature data<a class="headerlink" href="#Detrend-Land-Surface-Temperature-data" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">detrend</span>

<span class="c1"># Load the raster file</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;./data/morenny/LST/Mean_LST_Jul_Aug.tif&#39;</span>

<span class="c1"># Read the raster data using rasterio</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">raster</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Read the first band</span>


<span class="c1"># Replace NaN or infinite values in the raster</span>
<span class="n">finite_values</span> <span class="o">=</span> <span class="n">raster</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">raster</span><span class="p">)]</span>
<span class="n">mean_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">finite_values</span><span class="p">)</span>
<span class="n">raster_cleaned</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">raster</span><span class="p">),</span> <span class="n">raster</span><span class="p">,</span> <span class="n">mean_value</span><span class="p">)</span>

<span class="c1"># Detrend the cleaned raster data</span>
<span class="n">detrended_raster</span> <span class="o">=</span> <span class="n">detrend</span><span class="p">(</span><span class="n">raster_cleaned</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Detrend along rows (NS direction)</span>


<span class="c1"># Reopen the original raster to get its metadata for exporting</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">meta</span>

<span class="c1"># Update the metadata for the detrended raster</span>
<span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># File path for the detrended raster GeoTIFF</span>
<span class="n">detrended_raster_file</span> <span class="o">=</span> <span class="s1">&#39;./data/morenny/LST/Detrended_Mean_LST_Jul_Aug.tif&#39;</span>

<span class="c1"># Write the detrended raster to a new GeoTIFF file</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">detrended_raster_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">detrended_raster</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_viewer</span><span class="p">(</span>
    <span class="n">path_to_dem_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/basemap.tif&#39;</span><span class="p">,</span>
    <span class="n">raster_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/LST/Mean_LST_2020_aoi.tif&#39;</span><span class="p">,</span>
    <span class="n">output_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/&#39;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Land surface Temperature&#39;</span><span class="p">,</span>
    <span class="n">pixel_resolution_meters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_file_name</span><span class="o">=</span><span class="s1">&#39;LST.png&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">unit_conversion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">no_data_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;hsv_r&#39;</span><span class="p">,</span>
    <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;celsius-degree &#39;</span><span class="p">,</span>
    <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span>

<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_32_0.png" src="../_images/notebooks_RockGlacier_radar_asc_32_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">akhdefo_functions</span><span class="o">.</span><span class="n">akhdefo_viewer</span><span class="p">(</span>
    <span class="n">path_to_dem_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/basemap.tif&#39;</span><span class="p">,</span>
    <span class="n">raster_file</span><span class="o">=</span><span class="s1">&#39;./data/morenny/LST/Detrended_Mean_LST_Jul_Aug_aoi.tif&#39;</span><span class="p">,</span>
    <span class="n">output_folder</span><span class="o">=</span><span class="s1">&#39;./data/morenny/radar/asc/Figs_analysis/&#39;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Detrended Land surface Temperature&#39;</span><span class="p">,</span>
    <span class="n">pixel_resolution_meters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_file_name</span><span class="o">=</span><span class="s1">&#39;Detrend_LST.png&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">unit_conversion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">no_data_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;hsv_r&#39;</span><span class="p">,</span>
    <span class="n">min_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;celsius-degree &#39;</span><span class="p">,</span>
    <span class="n">show_figure</span><span class="o">=</span><span class="kc">True</span>

<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_33_0.png" src="../_images/notebooks_RockGlacier_radar_asc_33_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ee</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>  <span class="c1"># For enhanced plot styling</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>


<span class="c1"># Initialize the Earth Engine module.</span>
<span class="n">ee</span><span class="o">.</span><span class="n">Authenticate</span><span class="p">()</span>
<span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>

<span class="c1"># Define your area of interest (AOI) using latitude and longitude</span>
<span class="n">lat</span> <span class="o">=</span> <span class="mf">42.99</span>
<span class="n">lon</span> <span class="o">=</span> <span class="mf">76.99</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">])</span>

<span class="c1"># Define a 5km by 5km square around the point</span>
<span class="c1">#square = point.buffer(500).bounds()  # Buffer by 4000 meters (4 km) and get bounds</span>
<span class="n">square</span><span class="o">=</span><span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="mf">76.9868751901</span><span class="p">,</span> <span class="mf">42.9914296961</span><span class="p">,</span> <span class="mf">77.0048813882</span><span class="p">,</span> <span class="mf">43.0093232151</span><span class="p">)</span>


<span class="c1"># Cloud mask function</span>
<span class="k">def</span> <span class="nf">maskL8sr</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="n">cloudShadowBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span>
    <span class="n">cloudsBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>
    <span class="n">qa</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;pixel_qa&#39;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudShadowBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudsBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

<span class="c1"># Load and process the Landsat 8 Image Collection</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">maskL8sr</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-10-01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>

<span class="c1"># Function to calculate LST for each image in the collection</span>
<span class="k">def</span> <span class="nf">calculateLST</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">ndvi</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mf">0.004</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mf">0.986</span><span class="p">)</span>
    <span class="n">LST</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;(Tb/(1 + (0.00115 * (Tb / 1.438)) * log(Ep)))-273.15&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="s1">&#39;Tb&#39;</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
      <span class="s1">&#39;Ep&#39;</span><span class="p">:</span> <span class="n">ndvi</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;LST&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">LST</span><span class="p">)</span>

<span class="c1"># Add LST band to each image in the collection</span>
<span class="n">lstCol</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">calculateLST</span><span class="p">)</span>

<span class="c1"># Function to add a &#39;year&#39; property to each image</span>
<span class="k">def</span> <span class="nf">addYear</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;system:time_start&#39;</span><span class="p">))</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">toInt</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>

<span class="c1"># Apply the addYear function to each image in the collection</span>
<span class="n">lstCol</span> <span class="o">=</span> <span class="n">lstCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">addYear</span><span class="p">)</span>

<span class="c1"># Filter for July and August</span>
<span class="n">julAugCol</span> <span class="o">=</span> <span class="n">lstCol</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">calendarRange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">))</span>
<span class="c1">#julAugCol=lstCol</span>


<span class="c1"># Calculate the mean LST for each year</span>
<span class="n">yearlyMean</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span>
  <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">year</span><span class="p">:</span>
    <span class="n">julAugCol</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
  <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Function to extract data</span>
<span class="k">def</span> <span class="nf">extract_data</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">mean_dict</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">reducer</span><span class="o">=</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">geometry</span><span class="o">=</span><span class="n">square</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">mean_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LST&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Use get method with a default value of None</span>

<span class="c1"># Extract the mean LST for each year and convert to a Pandas DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">2021</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">yearlyMean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
    <span class="n">lst_value</span> <span class="o">=</span> <span class="n">extract_data</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lst_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lst_value</span><span class="p">)</span>
        <span class="n">years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="n">years</span><span class="p">,</span> <span class="s1">&#39;LST&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>


<span class="c1"># Fitting a linear model to the data</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;LST&#39;</span><span class="p">])</span>

<span class="c1"># Calculate the line of best fit</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Trendline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span>

<span class="c1"># Create a Plotly figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;LST&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean LST for July and August (2017-2021) with Trendline&#39;</span><span class="p">)</span>

<span class="c1"># Add a scatter plot for Mean LST</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LST&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Mean LST&#39;</span><span class="p">))</span>

<span class="c1"># Add a trendline</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Trendline&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Trendline&#39;</span><span class="p">))</span>

<span class="c1"># Calculate the rate of change annotation</span>
<span class="n">rate_of_change</span> <span class="o">=</span> <span class="n">slope</span>

<span class="c1"># Annotate the rate of change in the legend</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                         <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Rate of Change: </span><span class="si">{</span><span class="n">rate_of_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°C/year&#39;</span><span class="p">))</span>

<span class="c1"># Customize the appearance</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;Legend&#39;</span><span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<img alt="LST Profile" src="../_images/LST_TS.png" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="c1"># Load the CSV file</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;./data/morenny/LST/Mean_LST_Jul_Aug_2017_to_2023.csv&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the dataframe to understand its structure</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># Selecting relevant columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;LST&#39;</span><span class="p">]]</span>

<span class="c1"># Removing any null/NaN values</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ensuring &#39;year&#39; is an integer</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Performing a linear regression</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;LST&#39;</span><span class="p">])</span>

<span class="c1"># Generating values for the regression line</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>

<span class="c1"># Correcting the line plot code</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;LST&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Plotting the regression line</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Annotating the rate of change</span>
<span class="n">rate_of_change</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rate of Change: </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> °C/year&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rate_of_change</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="c1"># Setting plot titles and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Yearly Mean Land Surface Temperature (LST) Trend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean LST (°C)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_RockGlacier_radar_asc_36_0.png" src="../_images/notebooks_RockGlacier_radar_asc_36_0.png" />
</div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/akhdefo_logo.svg" alt="Logo"/>
            </a></p>
  

  <h3>Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Morenney Rock Glacier Radar Ascending</a><ul>
<li><a class="reference internal" href="#Prepare-Data-for-Bulk-Download">Prepare Data for Bulk Download</a></li>
<li><a class="reference internal" href="#Import-AkhDefo-Packages.">Import AkhDefo Packages.</a></li>
<li><a class="reference internal" href="#Download-Data-using-EarthData-ASF-Account">Download Data using EarthData ASF Account</a></li>
<li><a class="reference internal" href="#Extract-downloaded-zip-files">Extract downloaded zip files</a></li>
<li><a class="reference internal" href="#Preparing-raster-for-radar-flow-and-displacement-calculation!">Preparing raster for radar flow and displacement calculation!</a></li>
<li><a class="reference internal" href="#Applying-radar-flow-and-producing-time-series-deformation-products.">Applying radar flow and producing time-series deformation products.</a></li>
<li><a class="reference internal" href="#Interpolate-and-Create-raster-Velocities">Interpolate and Create raster Velocities</a></li>
<li><a class="reference internal" href="#Visualize-Displacement-Products">Visualize Displacement Products</a></li>
<li><a class="reference internal" href="#Interactive-Time-Series-Analysis-in-a-Dash-Web-App">Interactive Time Series Analysis in a Dash Web App</a></li>
<li><a class="reference internal" href="#Plot-Mean-Land-Surface-Temperature-for-months-July-and-August-2017-to-2021">Plot Mean Land Surface Temperature for months July and August 2017 to 2021</a><ul>
<li><a class="reference internal" href="#Detrend-Land-Surface-Temperature-data">Detrend Land Surface Temperature data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<ul>
  <li><a href="../index.html">Overview</a>
    <ul>
          <li>Previous: <a href="RockGlacier_optical.html" title="previous chapter">Morenny Rock Glacier Optical Imagery Example</a>
          <li>Next: <a href="RockGlacier_radar_desc.html" title="next chapter">Morenney Rock Glacier Radar Descending</a>
    </ul>
  </li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div id="ethical-ad-placement"></div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Mahmud Mustafa Muhammad.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  <script src="../_static/version_warning_offset.js"></script>

  </body>
</html>